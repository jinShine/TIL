# 2.React Testing Library



{% hint style="info" %}
React ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©ì ì…ì¥ì— ê°€ê¹ê²Œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ë„êµ¬.
{% endhint %}

> [React Testing Library](https://github.com/testing-library/react-testing-library)\
> [jest-dom](https://github.com/testing-library/jest-dom)

React ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©ì ì…ì¥ì— ê°€ê¹ê²Œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ë„êµ¬\
UI í…ŒìŠ¤íŠ¸ì— íŠ¹í™”ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬\
E2E Testì²˜ëŸ¼ ì‚¬ìš© ê°€ëŠ¥ â†’ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©ìê°€ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ë“¯ì´ í…ŒìŠ¤íŠ¸



```tsx
// TextField.test.tsx

import {render, screen} from '@testing-library/react';

import TextField from './TextField';

test('TextField', () => {
    // Given
    const text = 'Tester';
    const setText = () => {
        // do nothing...
    };

    // When
    render((
        <TextField
            label="Name"
            placeholder="Input your name"
            text={text}
            setText={setText}
        />
    ));

    // Then
    screen.getByLabelText('Name');
    screen.getByPlaceholderText(/name/);
    screen.getByDisplayValue(text);
});
```



**ì£¼ì˜ì **

* ğŸ’¡ UIëŠ” ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ë¥¼ í†µí•´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ë¶„ë¦¬í•˜ëŠ” ê²ƒì„ ê¶Œì¥\
  ë²”ìš©ì„±ì´ ì»¤ì§€ê³  ë‹¤ë¥¸ ê³³ì—ì„œ í„°ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì²˜ìŒë¶€í„° UIë¥¼ ë˜ë„ë¡ ê°„ë‹¨í•˜ê²Œ í•  ê²ƒ
* ê³µìš© ë¡œì§ì„ ì´˜ì´˜í•˜ê²Œ ë§Œë“¤ê¸°
* ë‚˜ë¨¸ì§€ ë¶€ë¶„ì€ ëª¨ë“ˆì„ ëª¨í‚¹í•˜ê±°ë‚˜ ë°±ì—”ë“œ ë¶€ë¶„ì€ MSWë¥¼ ì‚¬ìš©í•´ ì²˜ë¦¬í•˜ê¸°



1. context ë¶„ë¦¬

```tsx
import {render, screen, fireEvent} from '@testing-library/react';

import TextField from './TextField';

const context = describe;

describe('TextField', () => {
    // Given
    const label = 'Name';
    const text = 'Tester';

    const setText = jest.fn(); // ëª¨í‚¹

    it('renders elements', () => {
        // When
        render((
            <TextField
                label={label}
                placeholder='Input your name'
                text={text}
                setText={setText}
            />
        ));

        // Then
        screen.getByLabelText(label);
        screen.getByPlaceholderText(/name/);
        screen.getByDisplayValue(text);
    });

    context('when user enters name', () => {
        it('calls "setText" handler', () => {
            // Given
            render((
                <TextField
                    label={label}
                    placeholder='Input your name'
                    text={text}
                    setText={setText}
                />
            ));

            // When
            fireEvent.change(screen.getByLabelText(label), {
                target: {value: 'New Name'},
            });

            // Then
            expect(setText).toBeCalledWith('New Name');
        });
    });
});
```

#### 2. render í•¨ìˆ˜ ìƒì„±, ëª¨í‚¹ í•¨ìˆ˜ ì´ˆê¸°í™” ì²˜ë¦¬

* ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ Extract Function
* fireEvent ë“±ì„ í†µí•´ ì¸í„°ë™ì…˜ë§Œ ê²€ì¦
* ë§Œì•½ ë³µì¡í•œ ë¡œì§ì´ ì»´í¬ë„ŒíŠ¸ë¡œë¶€í„° ë¶„ë¦¬ëœë‹¤ë©´, ì—¬ê¸°ì„œëŠ” ì´ê²ƒë§Œ ê²€ì¦í•˜ë©´ ë¨
  * Ex. setTextì— ìˆ«ìë§Œ ì…ë ¥ë°›ê²Œ í•˜ê³  ì‹¶ë‹¤ë©´, ì»´í¬ë„ŒíŠ¸ì—ì„œ ê·¸ëŸ° ë¡œì§ì„ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í…ŒìŠ¤íŠ¸ í•  ë•Œ ê·¸ë ‡ê²Œ ë™ì‘í•˜ë„ë¡ ì‘ì„±í•˜ë©´ ë¨
  * ğŸ’¡ ì»´í¬ë„ŒíŠ¸ì˜ ì±…ì„ì´ ì•„ë‹ˆê²Œ ë¨

```tsx
import {render, screen, fireEvent} from '@testing-library/react';

import TextField from './TextField';

const context = describe;

describe('TextField', () => {
    const text = 'Tester';
    const setText = jest.fn(); // ë§¤ í…ŒìŠ¤íŠ¸ë§ˆë‹¤ ì´ˆê¸°í™” í•´ì£¼ì–´ì•¼ í•¨ 

    beforeEach(() => {
        setText.mockClear(); // â†’ í•´ë‹¹ ëŒ€ìƒë§Œ clear
        // ë˜ëŠ” jest.clearAllMocks(); â†’ ì „ë¶€ ë‹¤ clear
    });

    function renderTextField() {
        render((
            <TextField
                label="Name"
                placeholder="Input your name"
                text={text}
                setText={setText}
            />
        ));
    }

    function inputText(value: string) {
        fireEvent.change(screen.getByLabelText(label), {
            target: {value},
        });
    }

    it('renders an input control', () => {
        // When
        renderTextField();

        // Then
        screen.getByLabelText('Name');
    });


    context('when user enters name', () => {
        beforeEach(() => {
            // Given
            renderTextField();
        });

        it('calls "setText" handler', () => {
            // When
            inputText('New Name');

            // Then
            expect(setText).toBeCalledWith('New Name');
        });
    });
});
```



ë§Œì•½ ì™¸ë¶€ ì˜ì¡´ì„±ì´ í° ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤ë©´, í•´ë‹¹ ë¶€ë¶„ë§Œ ê°€ì§œë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

```jsx
import { render, screen } from '@testing-library/react';

import App from './App';

**jest.mock**('./hooks/useFetchProducts', () => () => [
	{
		category: 'Fruits', price: '$1', stocked: true, name: 'Apple',
	},
]);

test('App', () => {
	render(<App />);

	screen.getByText('Apple');
});
```

ì¼ë°˜ì ìœ¼ë¡  ë°±ì—”ë“œì™€ ì†Œí†µí•˜ëŠ” ë¶€ë¶„ì´ ì°¨ì§€í•˜ëŠ” ë¹„ì¤‘ì´ í°ë°, ì´ ë¶€ë¶„ì„ í•˜ë‚˜ì”© ê°€ì§œ êµ¬í˜„ìœ¼ë¡œ ë°”ê¾¸ë‹¤ ë³´ë©´ ì–´ë ¤ìš¸ ë•Œê°€ ìˆë‹¤. ì´ëŸ´ ë• MSW ë“± ë‹¤ë¥¸ ëŒ€ì•ˆì„ ê³ ë ¤í•´ ë³´ì.



## Test fixture

[Test fixture](https://en.wikipedia.org/wiki/Test\_fixture)

ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ **ì¼ê´€ë˜ê²Œ í…ŒìŠ¤íŠ¸**í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” í™˜ê²½\
í•œ ê³³ì— ëª°ì•„ì„œ ë‹¤ë¥¸ ê³³ì—ì„œ ì‚¬ìš©í•˜ê¸° í¸ë¦¬í•¨

### ì¥ì 

* ê° í…ŒìŠ¤íŠ¸ê°€ í•­ìƒ ë™ì¼í•œ ì„¤ì •ìœ¼ë¡œ ì‹œì‘í•˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ë¥¼ ë°˜ë³µí•  ìˆ˜ ìˆìŒ
* ë©”ì†Œë“œë¥¼ ë‹¤ë¥¸ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•˜ê³  ê° ê¸°ëŠ¥ì„ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
* í…ŒìŠ¤íŠ¸ ì½”ë“œ ì„¤ê³„ê°€ ìš©ì´í•¨
* ì´ì „ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì—ì„œ ë‚¨ì€ í•­ëª©ìœ¼ë¡œ ì‘ì—…í•˜ëŠ” ëŒ€ì‹ , ì•Œë ¤ì§„ ì´ˆê¸° ìƒíƒœë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ë¯¸ë¦¬ êµ¬ì„±

### í´ë” êµ¬ì¡°

#### 1. ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

```
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ App.test.tsx
â”‚   â”œâ”€â”€ App.tsx
```

```
â”œâ”€â”€ fixtures
â”‚   â”œâ”€â”€ index.ts
â”‚   â””â”€â”€ products.ts
```

```js
// App.test.ts

import {render, screen} from '@testing-library/react';
import App from './App';
import fixtures from '../fixtures';

jest.mock('./hooks/useFetchProducts', () => () => fixtures.products);

test('App', () => {
    render(<App/>);

    screen.getByText('Apple');
});
```

```js
// fixtures/products.ts

const products = [
    {
        category: 'Fruits', price: '$1', stocked: true, name: 'Apple',
    },
];

export default products;
```

```js
// fixtures/index.ts

import products from './products';

export default {
    products,
};
```

#### 2. **mocks** í´ë”ë¥¼ ë¶„ë¦¬í•  ê²½ìš°

ë³µì¡í•´ì§€ë©´ ì´ ë°©ë²•ì„ ì‚¬ìš©

```
â”‚   â”œâ”€â”€ hooks
â”‚   â”‚   â”œâ”€â”€ __mocks__
â”‚   â”‚   â”‚   â””â”€â”€ useFetchProducts.ts
â”‚   â”‚   â””â”€â”€ useFetchProducts.ts
```

```js
// App.test.ts

import {render, screen} from '@testing-library/react';
import App from './App';

// Jest.mock('./hooks/useFetchProducts', () => () => fixtures.products);
jest.mock('./hooks/useFetchProducts');

test('App', () => {
    render(<App/>);

    screen.getByText('Apple');
});
```

```js
// hooks/__mocks__/useFetchProducts.ts

import fixtures from '../../../fixtures';

// Const useFetchProducts = () => fixtures.products; // ì´ë ‡ê²Œ ì¨ë„ ë˜ì§€ë§Œ 
const useFetchProducts = jest.fn(() => fixtures.products); // ëª¨í‚¹ì„ ë“œëŸ¬ë‚´ê¸° ìœ„í•´ ê¶Œì¥ë˜ëŠ” ë°©ë²•  

export default useFetchProducts;
```

